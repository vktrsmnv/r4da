{
  "hash": "ad8bc069f27e93a4e6681aebbf73d352",
  "result": {
    "markdown": "---\ntitle: \"Uncertainty and Statistical Inference\"\nsubtitle: \"Data Analytics and Visualization with R<br>Session 7\"\ntitle-slide-attributes:\n  data-background-size: stretch\n  data-slide-number: none\nauto-stretch: false\ninstitute: \"University of Mannheim<br>Spring 2023\"\nauthor: \"Viktoriia Semenova\"\nfooter: \"[ðŸ”— r4da.live](https://r4da.live/)\"\nlogo: images/logo.png\nformat:\n  revealjs:\n    theme: ../slides.scss\n    transition: fade\n    incremental: true   \n    slide-number: true\n    chalkboard: true\nexecute:\n  echo: true\neditor_options: \n  chunk_output_type: console\neditor: \n  markdown: \n    wrap: 80\n---\n\n\n\n\n<!-- # Intro -->\n\n<!-- ## Quiz: Which of these statements are correct? {.smaller} -->\n\n<!-- ```{r} -->\n<!-- #| echo: false -->\n<!-- countdown(minutes = 4, color_background = \"white\", left = 1) -->\n<!-- ``` -->\n\n<!-- You are interested in the effect of *Beauty* on *Teaching Evaluations*. Suppose we have a DAG that looks something like this and we obtained the coefficient estimates of 3.74 for the *Intercept*, 0.08 for *Beauty* and -0.20 for *Female*. -->\n\n<!-- ::: columns -->\n<!-- ::: {.column width=\"30%\"} -->\n\n<!-- ```{dot} -->\n<!-- //| echo: false -->\n<!-- //| fig-width: 3 -->\n<!-- //| fig-height: 3 -->\n<!-- //| out-width: 100% -->\n<!-- digraph D { -->\n<!--   node [shape=oval, fontname=\"AtkinsonHyperlegible-Regular\"]; -->\n<!--   edge [minlen = 1.2, arrowhead = vee, arrowsize=0.5]; -->\n<!--   a [label = \"Beauty Score\"]; -->\n<!--   b [label = \"Evaluations\"]; -->\n<!--   c [label = \"Female\"]; -->\n\n<!--   {rank=same a b}; -->\n<!--   {rank=sink c}; -->\n<!--   a->b; -->\n<!--   c->a; -->\n<!--   c->b; -->\n<!-- } -->\n<!-- ``` -->\n\n\n<!-- :::  -->\n<!-- ::: {.column width=\"70%\"} -->\n\n<!-- 1.  After specifying the DGP in a DAG and following our identification strategy, we can interpret the estimated coefficient for the effect of *Beauty Score* on *Evaluations* causally. -->\n\n<!-- 2.  After specifying the DGP in a DAG and following our identification strategy, we can interpret the estimated coefficient for the effect of *Female* on *Evaluations* causally. -->\n\n<!-- 3. On average, a 5-point increase in *Beauty Score* would be associated with 0.4-point increase in *Teaching Evaluations*, for both female and female instructors.  -->\n\n<!-- 4. The effect of *Female* on *Teaching Evaluations* would be represented through the change in the slope of the regression coefficient for *Beauty Score*.  -->\n\n<!-- 5. For $evals = \\beta_0 + \\beta_1 \\cdot Female$,  $\\beta_1$ would be the equal to difference-in-means estimator.  -->\n\n<!-- :::  -->\n<!-- :::  -->\n\n<!-- ## Parallel Lines  -->\n\n<!-- ```{r, echo=FALSE} -->\n<!-- evals %>% -->\n<!--   mutate(female = if_else(female == 1, \"Female\", \"Male\")) %>% -->\n<!--   ggplot(aes(beauty, y = eval, color = (female))) + -->\n<!--   geom_jitter( -->\n<!--     size = 2, -->\n<!--     alpha = 0.5, -->\n<!--     width = 0.1 -->\n<!--   ) + -->\n<!--   labs( -->\n<!--     x = \"Beauty\", -->\n<!--     y = \"Average Teaching Evaluation\", -->\n<!--     title = \"Relationship between Instructor Beauty and Course Evaluations\", -->\n<!--     color = \"Instructor is\" -->\n<!--   ) + -->\n<!--   geom_line(aes(y = predict(lm(eval ~ beauty + female, data = evals))), -->\n<!--             size = 1.2) + # plots the parallel lines -->\n<!--   scale_color_viridis_d(end = 0.8) + -->\n<!--   theme(legend.position = \"top\") + -->\n<!--   scale_x_continuous(limits = c(1, 10), breaks = 1:10) + -->\n<!--   ylim(c(1, 5.5)) + # why not c(1, 5)? -->\n<!--   theme(panel.grid.minor = element_blank()) -->\n<!-- ``` -->\n\n\n# Agenda for Today\n\n<br>\n\n**Model Assumptions**\n\n<br>\n\n**Sampling Variability and Sampling Distributions**\n\n<br>\n\n**Standard Errors, Confidence Intervals, p-values**\n\n<br>\n\n**Lab: Communicating Uncertainty**\n\n# Error Term in Regression Model\n\n## Errors in Regression  {.smaller}\n\nRandom noise, the *stochastic* component of the model: the sum of \"everything else\" not in the systematic component of the model\n    \n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-1-1.png){fig-align='center' width=2100 height=90%}\n:::\n:::\n\n<!-- $\\varepsilon \\sim \\mathcal{N}(0, \\sigma^2)$) -->\n\n## Errors in Regression  {.smaller}\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=2100 height=90%}\n:::\n:::\n\n\n## Error Variance and Regression Standard Error {.smaller}\n\nOnce we fit the model, we can use the residuals to estimate error variance (i.e. residual variance):\n\n$$\n\\hat\\sigma^2 = \\frac{\\overbrace{\\sum_{i=1}^{n}\\hat{e}_i^2}^{\\text{sum of squared residuals}}}{\n\\underbrace{\n\\underbrace{n}_{\\text{number of}\\\\\\text{observations}}-\\underbrace{k}_{\\text{number of}\\\\\\text{covariates}} - 1\n}_{\\text{degrees of freedom}}\n}\n$$\n\nRegression standard error  $\\sqrt{\\hat\\sigma^2}$:\n\n-  A measure of the average error (average difference between observed and  predicted values of the outcome) in same units as the outcome variable\n\n<!-- ## Model Fit Evaluation {.smaller} -->\n\n<!-- ##### Coefficient of Determination $R^2$ and Adjusted $R^2$ -->\n\n<!-- - Measure of the proportional reduction in error by the model, i.e. how well our model explain the variation in $Y$ -->\n\n<!-- - Measure of *in-sample* fit: how well your model predicts the data used to estimate it -->\n\n<!-- ::: columns -->\n\n<!-- ::: {.column width=\"50%\"} -->\n\n<!-- $$R^2=\\frac{ESS}{TSS}=\\frac{TSS-RSS}{TSS}$$ -->\n\n<!-- - $R^2 \\in [0,1]$ -->\n\n<!-- - Increases the more explanatory variables we add -->\n\n<!-- ::: -->\n\n<!-- ::: {.column width=\"50%\"} -->\n\n<!-- $$Adj.R^2=1 - (1 - R^2)\\frac{n-1}{n-k-1}$$ -->\n\n<!-- - May take negative values (bad model fit) -->\n\n<!-- - Adds penalty for including more variables $k$ (and sample size $n$) -->\n\n<!-- ::: -->\n\n<!-- ::: -->\n\n<!-- - *Out-of-sample fit*: how well your model predicts new data (our goal in predictive modeling) -->\n\n<!-- ## Poll -->\n\n<!-- The $R^2$  of the model for predicting course evaluation from average beauty score is 22.3%. Which of the following is the correct interpretation of this value? -->\n\n<!-- 1. Average beauty scores correctly predict 22.3% of course evaluations in University of Texas. -->\n\n<!-- 2. 22.3% of the variability in course evaluations in University of Texas can be explained by average beauty scores of the instructors. -->\n\n<!-- 3. 22.3% of the variability in average beauty scores can be explained by course evaluations in University of Texas. -->\n\n<!-- 4. 22.3% of the time course evaluations in University of Texas can be predicted by average beauty scores of the instructors. -->\n\n<!-- ::: -->\n\n# Model Conditions\n\n## Conditions for Inference {.smaller}\n\n- *Linearity:* There is a linear relationship between the outcome and predictor variables\n- *Independence:* The errors are independent from each other, i.e. knowing the error term for one observation doesn't tell you anything about the error term for another observation\n- *Normality:* The distribution of errors is approximately normal $\\varepsilon|X \\sim \\mathcal{N}(0, \\sigma^2)$\n- *Constant variance:* The variability of the errors is equal for all values of the predictor variable, i.e. the errors are homeoscedastic\n\n## Linearity Assumption {.smaller}\n\n- Check the plot of residuals vs. predicted values for patterns \n\n- If you observe any patterns, you can look at individual plots of residuals vs. each predictor to try to identify the issue\n\n- Look for patterns in predictors you treat as continuous, for binary predictors the assumption is always met \n\n- Transformations of variables could sometimes address the problems\n\n- Violation will bias the coefficients and pose problems for uncertainty measures and hypothesis testing \n\n## Linearity Assumption Violation {.smaller}\n\n\n::: {.cell layout-ncol=\"2\" layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\nRows: 90 Columns: 7\nâ”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nDelimiter: \",\"\nchr (2): season, day_type\ndbl (5): volume, hightemp, avgtemp, cloudcover, precip\n\nâ„¹ Use `spec()` to retrieve the full column specification for this data.\nâ„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=2100}\n:::\n\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-3-2.png){fig-align='center' width=2100}\n:::\n\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-3-3.png){fig-align='center' width=2100}\n:::\n\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-3-4.png){fig-align='center' width=2100}\n:::\n:::\n\n\n\n## Independence Assumption {.smaller}\n\n- Examples of violation: if the observations are clustered, e.g.\n    - there are repeated measures from the same individual, as in longitudinal data\n    - if classrooms were first sampled followed by sampling individuals within classes\n    \n- We can often check the independence condition based on the context of the data and how the observations were collected  \n\n- If the data were collected in a particular order, examine a scatterplot of the residuals versus order in which the data were collected\n\n- Violations may not bias the coefficient, but will pose problems for uncertainty measures and hypothesis testing \n\n## Normality Assumption {.smaller}\n\n- At any given predictor value the distribution of outcome given predictor is assumed to be normal\n\n- Compare the distributions of residuals to a normal distribution \n\n- Violations may pose problems for uncertainty measures and hypothesis testing in small samples \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=2100 height=90%}\n:::\n:::\n\n\n\n\n## Constant Variance Assumption {.smaller}\n\n- The vertical spread of the residuals is not constant across the plot\n\n- Non-constant error variance could mean we predict some observations better (i.e. with less error) than others \n\n- Violation results in inaccurate confidence intervals and p-values\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=2100 height=90%}\n:::\n:::\n\n\n# Uncertainty\n\n## Statistical Inference {.smaller}\n\n... is the process of using sample data to make conclusions about the underlying\npopulation the sample came from\n\n\n```{dot}\n//| echo: false\ndigraph G {\n  forcelabels=true;\n  splines=false;\n  fontname=\"AtkinsonHyperlegible-Regular\";\n  population [\n    label = \"Population\";\n    shape = circle; \n  ];\n  sample [\n    label = \"Sample\";\n    shape = oval;\n  ];\n\n  population -> sample  [xlabel = <<font color=\"grey\">      Probability</font>>;  color = \"grey\"];\n  sample -> population [xlabel = \"   Inference\";];\n  \n  {rank = same population; sample}\n}\n```\n\n\n## Sampling in Real Life {.smaller}\n\n![](https://sta210-s22.github.io/website/slides/images/lec-5/soup.png){width=\"365\"}\n\n-   When you taste a spoonful of soup and decide the spoonful you tasted isn't\n    salty enough, that's exploratory analysis\n-   If you generalize and conclude that your entire soup needs salt, that's an     inference\n-   For your inference to be valid, the spoonful you tasted (the sample) needs to be representative of the entire pot (the population)\n\n## Why Communicate Uncertainty {.smaller}\n\n> If you want to estimate a population parameter, do you prefer to report a\n> range of values the parameter might be in, or a single value?\n\n::: columns\n::: {.column width=\"50%\"}\n-   If we report a point estimate, we probably won't hit the exact population\n    parameter\n\n![](images/darts.png){width=\"500\"}\n:::\n\n::: {.column width=\"50%\"}\n-   If we report a range of plausible values, we have a good shot at capturing\n    the parameter\n\n![](images/rings.png){width=\"500\"}\n:::\n:::\n\n## How to Communicate Uncertainty {.smaller}\n\n-   *Standard error*: since point estimates vary from sample to sample, we\n    quantify this variability with what is called the *standard error* (SE).\n    *Standard error* is a *standard deviation* of the sampling distribution of a\n    statistic.\n\n$$\nSE(\\hat\\beta_1)= \\sqrt{Var(\\hat{\\beta_1})}, \\qquad Var(\\hat{\\beta_1}) = \\frac{\\overbrace{\\hat\\sigma^2}^{\\text{estimated regression error}^2\\\\\\text{a.k.a. residual variance}}}{\\underbrace{\\sum_{i=1}^{n}(x_i - \\bar x)^2}_{\\text{sum of squared deviations of } x}}\n$$\n\n-   *Confidence interval*: a range of our best guesses about the point estimate.\n    One way to calculate it is using the *standard error*.\n\n> We call a confidence interval a $(1 - \\alpha)$% confidence interval if it is constructed such that it contains the true parameter at least $(1 - \\alpha)$% of the time if we repeat the experiment a large number of times.\n\n## Thought Experiment {.smaller}\n\nSuppose we had data for the whole population (100'000 students) and we could estimate the true parameter values:\n\n$$\n\\text{Evaluations} = \\beta_0 + \\beta_1 \\cdot \\text{Beauty Score} + \\varepsilon\n$$\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\nCompare these values to estimates from a random sample of 500 students:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(term)`\n```\n:::\n\n::: {.cell-output-display}\n|term        | parameter| estimate|\n|:-----------|---------:|--------:|\n|(Intercept) |     3.691|    3.712|\n|beauty      |     0.070|    0.074|\n:::\n:::\n\n\n## Sampling Variability {.smaller}\n\nNow let's take 5000 samples (N = 1000) from this population of 100'000 students,\nrun the same bivariate model on each of these samples, and plot the results:\n\n\n::: {.cell layout-align=\"center\" hash='07-regression_cache/html/unnamed-chunk-9_0d030a40a11daee8334ba3965ee695e1'}\n\n:::\n\n\n<!-- - Sampling distributions are not observed in real life  -->\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nâ„¹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=2100}\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\nScale for x is already present.\nAdding another scale for x, which will replace the existing scale.\n```\n:::\n\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=2100}\n:::\n:::\n\n:::\n:::\n\n## Sampling Distributions {.smaller}\n\n-   Sampling distributions are *hypothetical* constructs, underlying the logic\n    of frequentist approach to statistics. We never observe them in real life\n\n-   Sampling distributions (of many statistics) are approximately normally\n    distributed (if the sample size is sufficiently large)\n\n-   Sampling distributions are centered at the true value of the population\n    coefficient (the value we would get from linear modeling if we did indeed\n    use the full population)\n\n-   The spread of the sampling distribution gives us a measure of the\n    *precision* of our estimate:\n\n    -   If the sampling distribution is very wide, then our estimate is\n        imprecise; our estimate would vary widely from sample to sample\n    -   If the sampling distribution is very narrow, then our estimate is\n        precise; our estimate would not vary much from sample to sample\n\n## Standard Error {.smaller}\n\nStandard Error are Standard Deviations of Sampling Distributions:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# SD of sampling distributions\nestimates %>% \n  group_by(term) %>% \n  summarize(sd = sd(estimate))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 2\n  term            sd\n  <chr>        <dbl>\n1 (Intercept) 0.0545\n2 beauty      0.0114\n```\n:::\n\n```{.r .cell-code}\n# estimates SEs  \nestimates %>% \n  filter(sample == 10) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 9\n  term        estimate std.error statistic       p.value conf.low conf.high n     sample\n  <chr>          <dbl>     <dbl>     <dbl>         <dbl>    <dbl>     <dbl> <chr>  <int>\n1 (Intercept)   3.71      0.0533     69.6  0               3.61      3.82   1000      10\n2 beauty        0.0676    0.0112      6.01 0.00000000266   0.0455    0.0896 1000      10\n```\n:::\n\n```{.r .cell-code}\n# estimates SEs  \nestimates %>% \n  filter(sample == 1000) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 9\n  term        estimate std.error statistic     p.value conf.low conf.high n     sample\n  <chr>          <dbl>     <dbl>     <dbl>       <dbl>    <dbl>     <dbl> <chr>  <int>\n1 (Intercept)   3.78      0.0526     71.8  0             3.67      3.88   1000    1000\n2 beauty        0.0570    0.0114      4.99 0.000000724   0.0346    0.0795 1000    1000\n```\n:::\n:::\n\n\n> If we took samples of N = 100 and not N = 1000, what should happen to the spread of sampling distributions?\n\n## Sample Size and Precision {.smaller}\n\nLarger samples allow for more precise estimates (i.e. smaller standard errors)\n\n\n::: {.cell layout-align=\"center\" hash='07-regression_cache/html/unnamed-chunk-13_7f9a95eab523517df9e09005601d5e9f'}\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=2100 height=80%}\n:::\n:::\n\n\n> We cannot observe these distributions, but the SE provides us with the information about their variability\\\n> We can use this info to obtain a plausible range of estimates given our data, the confidence interval\n\n## Confidence Intervals {.smaller}\n\n-   Range of our best guesses about the point estimate with X% confidence  (accounting for sampling variability)\n-   If we have a large sample, we can estimate CIs from standard errors and  quantiles for the standard normal distribution  $\\mathcal{N}(\\mu = 0, \\sigma = 1)$:  $100 \\cdot (1 - \\alpha)$% confidence interval is $CI_{(1 - \\alpha)} = \\hat \\beta \\pm \\underbrace{z_{\\alpha / 2} \\cdot SE}_{\\text{Margin of Error}}$\n\n$$CI_{95} = \\hat \\beta \\pm 1.96 SE = [ \\hat \\beta - 1.96 SE;  \\hat\\beta + 1.96 SE]$$\n\n-   The procedure of how 95% confidence intervals are constructed ensures that:\n    -   when we draw *repeated samples*\n    -   95% of CIs calculated with this formula *on the respective samples*\n    -   cover the true parameter\n-   one single calculated CI tells us *nothing* about:\n    -   parameters in other samples\n    -   individual observations in our sample and/or population\n\n<!-- > The confidence level does not mean that there is 95% probability of each CI including true value. Confidence level is a statement about the procedure in general, not each individual interval. -->\n\n## Confidence Intervals Illustration\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(term)`\n```\n:::\n\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=2100}\n:::\n:::\n\n\n## Confidence Intervals as Ring Toss {.smaller}\n\n::: columns\n::: {.column width=\"70%\"}\n-   Each sample gives a different CI or toss of the ring\n-   Some samples the ring will contain the target (the CI will contain the\n    truth) other times it won't\n    -   We don't know if the CI for our sample contains the truth!\n-   *Confidence level*: percent of the time our CI will contain the population\n    parameter\n    -   Number of ring tosses that will hit the target.\n    -   We get to choose, but typical values are 90%, 95%, and 99%\n-   The confidence level of a CI determine how often the CI will be wrong\n\n> The confidence level does not mean that there is 95% probability of each CI including true value. Confidence level is a statement about the procedure in general, not each individual interval.\n:::\n\n::: {.column width=\"30%\"}\n![](images/rings.png)\n:::\n:::\n\n\n\n## Communicating Uncertainty: Examples {.smaller}\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsample_est <- students_population %>%\n  slice_sample(n = 500) %>%\n  lm(eval ~ beauty, data = .) %>%\n  tidy(conf.int = T, conf.level = 0.95) %T>% \n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 7\n  term        estimate std.error statistic   p.value conf.low conf.high\n  <chr>          <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)   3.65      0.0738     49.4  4.20e-194   3.50      3.79  \n2 beauty        0.0668    0.0159      4.19 3.33e-  5   0.0354    0.0981\n```\n:::\n:::\n\n\n> 95% confidence interval for the effect of *beauty* ranges from\n> 0.04 to\n> 0.1.\\\n> We are 95% confident that the effect of *beauty* on course eevaluations ranges\n> from, on average, 0.04 to\n> 0.1.\\\n> We are 95% confident that for each additional point in *beauty* score, we\n> would expect course evaluations to increase by\n> 0.04 to\n> 0.1 points, on average. \\\n> ~~With 95% probability the expected increase in course evaluataions ranges between\n> 0.04 to\n> 0.1 points for each additional unit of\n> beauty score.~~\n\n## Communicating Uncertainty {.smaller}\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=2100}\n:::\n:::\n\n\n\n## Accuracy vs. Precision Trade-off {.smaller}\n\n-   By design, confidence intervals of different levels vary in their width:\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsample_m %>% \n  tidy(conf.int = T, conf.level = 0.95) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 7\n  term        estimate std.error statistic   p.value conf.low conf.high\n  <chr>          <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)   3.63      0.0765     47.4  8.11e-187   3.48       3.78 \n2 beauty        0.0866    0.0163      5.30 1.71e-  7   0.0545     0.119\n```\n:::\n\n```{.r .cell-code}\nsample_m %>% \n  tidy(conf.int = T, conf.level = 0.99)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 7\n  term        estimate std.error statistic   p.value conf.low conf.high\n  <chr>          <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)   3.63      0.0765     47.4  8.11e-187   3.43       3.82 \n2 beauty        0.0866    0.0163      5.30 1.71e-  7   0.0444     0.129\n```\n:::\n:::\n\n\n-   This relates to the precision vs. accuracy of our interval estimates: the\n    higher the level we choose, the more certain we will be to cover the true\n    value\n-   But we also loose the precision of the estimate: wider ranges can become rather uninformative\n\n::: center\n![](images/download.png){width=\"600\"}\n:::\n\n<!-- ```{r} -->\n<!-- sample_m %>%  -->\n<!--   tidy(conf.int = T, conf.level = 1)  -->\n<!-- ``` -->\n\n# Hypothesis Testing\n\n## Decision Based on Confidence Intervals {.smaller}\n\n\n> Do the data provide sufficient evidence that Î²1 (the true slope for the population) is different from 0?\n\n<!-- - We start with our estimates and compare them to the value we are interested in. -->\n\n- Suppose we want to know if there is a linear effect of *beauty* on *evaluations* ($H_A: \\hat\\beta_1 \\neq 0$) or if there is no linear effect ($H_0: \\hat\\beta_1 = 0$) \n\n### Workflow:\n\n1.  Calculate the standard error and confidence interval (e.g., 95% CI)\n2.  Check if the confidence interval covers zero or not. \n  - If CI does not cover zero, we conclude that with 95% confidence, the slope coefficient is different from zero \n  - If CI covers zero, we conclude that with 95% confidence, the slope coefficient is not different from zero \n  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsample_est\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 7\n  term        estimate std.error statistic   p.value conf.low conf.high\n  <chr>          <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)   3.65      0.0738     49.4  4.20e-194   3.50      3.79  \n2 beauty        0.0668    0.0159      4.19 3.33e-  5   0.0354    0.0981\n```\n:::\n:::\n\n\n\n## Hypothesis Testing with *p-values* {.smaller}\n\n- Statistical hypothesis testing is a thought experiment: _What would the world look like if we knew the truth?_\n\n> Do the data provide sufficient evidence that Î²1 (the true slope for the population) is different from 0?\n\n#### Workflow:\n\n1.  Start with a null hypothesis, $H_0$ that represents the \"null-world\"\n2.  Set an alternative hypothesis, $H_A$ that represents the research question, i.e. what we're testing for\n3.  Conduct a hypothesis test under the assumption that the null hypothesis is true and calculate a p-value (probability of observed or more extreme outcome given that the null hypothesis is true)\n    -   if the test results suggest that the data do not provide convincing evidence for the alternative hypothesis, stick with the null hypothesis\n    -   if they do, then reject the null hypothesis in favor of the alternative\n\n## Course Evals of English Natives vs. Non-natives {.smaller}\n\n> Are courses taught by English natives evaluated higher than courses of non-natives?\n\n::: columns\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nevals %>% \n  group_by(nonenglish) %>% \n  summarize(avg_eval = mean(eval)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 2\n  nonenglish avg_eval\n       <dbl>    <dbl>\n1          0     4.02\n2          1     3.69\n```\n:::\n:::\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlm(eval ~ nonenglish, evals) %>% tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 Ã— 5\n  term        estimate std.error statistic p.value\n  <chr>          <dbl>     <dbl>     <dbl>   <dbl>\n1 (Intercept)    4.02     0.0264    152.   0      \n2 nonenglish    -0.329    0.107      -3.07 0.00229\n```\n:::\n:::\n\n:::\n:::\n\n$$\\hat\\beta_1 = 3.69 - 4.02 = - 0.33$$\n\n## Null Words with Permutation {.smaller}\n\n> How would the effect $\\hat\\beta_1$ look like if there was no difference?\n\n-   Shuffle the `eval` and `nonenglish` columns and calculate the difference in evaluations between natives and non-natives\n-   Repeat re-shuffling and estimation of the differences â†‘ 1000 times\n-   Check $\\hat\\beta_1$ in the null world: what is the probability of observing data as or more extreme as our data under the null (i.e. the *p-value*)?\n\n## Null Words with Permutation: Two-sided p-value {.smaller}\n\n\n::: {.cell layout-align=\"center\" hash='07-regression_cache/html/unnamed-chunk-22_77ef31f35606d029fc9871234586dd8b'}\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-22-1.png){fig-align='center' width=2100}\n:::\n:::\n\n\n\n## Null Words with Permutation: Slope Example {.smaller}\n\nRepeated permutations allow for quantifying the variability in the slope under the condition that there is no linear relationship (i.e., that the null hypothesis is true)\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](07-regression_files/figure-html/unnamed-chunk-23-1.png){fig-align='center' width=2100}\n:::\n:::\n\n\n\n\n## Main Take Aways {.smaller}\n\n-   Sampling variability implies uncertainty related to the estimation process: more data leads to more precise estimates (i.e. smaller SEs, narrower CIs)\n-   Confidence intervals quantify the uncertainty associated with the _average outcome_, not each individual prediction. Confidence level indicates how often, in the long run, the CI would be wrong (i.e. not contain the true value). We cannot know if the CI we obtained is a \"good\" or a \"bad\" one, though.   \n-  With hypothesis testing, we are comparing the null-world to our estimates. $p$-values indicate the probability of us observing the data at least as extreme as we have in the null-world\n\n# Appendix\n\n## Probabilistic Interpretation of CIs {.smaller}\n\n$$CI_{95}: [\\bar x - 1.96 SE, \\bar x + 1.96 SE]$$\n\n-   Randomness comes from the stage of drawing a sample (we only have one, but\n    hypothetically, we draw them repeatedly)\n\n-   **After we draw the random sample**, calculating the CI is a matter of\n    procedure:\n\n    -   there is no more randomness, it's just applying the formula\n    -   hence, we can think of this as a realized experiment\n    -   if CI bounds are just numbers, the true fixed value is either inside (1)\n        or not (0)\n    -   we say: a single *calculated* CI contains the true parameter or not (and\n        in real life, we don't know if it does, so we hope it is one of the ones\n        that cover the true value)\n\n-   **Before the random sample is drawn**, we can apply probabilistic\n    interpretation to CI:\n\n    -   for a 95% confidence interval (*before* the sample for calculating that\n        CI is drawn!), there is a 95% chance that a CI will contain $\\mu$\n    -   the **random** interval $[\\bar x - 1.96 SE, \\bar x + 1.96 SE]$ contains\n        $\\mu$ with probability 0.95. It is a random interval, since the\n        endpoints change with different samples (i.e., we don't have not drawn\n        the sample yet)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}